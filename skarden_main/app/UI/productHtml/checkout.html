<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="/skarden_main/app/UI/icon/png/prim1.1nbg.png" />
    <title>Checkout | Skarden</title>
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Bootstrap Icons -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css"
    />
    <style>
      /* Root Colors */
      :root {
        --dark-green: #2e7d32;
        --white: #ffffff;
        --light-gray: #f5f5f5;
        --text-dark: #111;
      }

      /* Body Styling */
      body {
        background-color: var(--light-gray);
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        color: var(--text-dark);
        padding-top: 2rem;
      }

      /* Hide Scrollbar */
      body::-webkit-scrollbar {
        display: none;
      }

      /* Container */
      .container {
        max-width: 1200px;
        margin: 0 auto;
        position: relative;
        z-index: 6;
      }

      /* Checkout Steps */
      .checkout-steps {
        display: flex;
        justify-content: space-between;
        margin-bottom: 2rem;
        position: relative;
      }
      .checkout-steps::before {
        content: "";
        position: absolute;
        top: 20px;
        left: 0;
        right: 0;
        height: 2px;
        background-color: #e0e0e0;
        z-index: 1;
      }

      .step {
        display: flex;
        flex-direction: column;
        align-items: center;
        position: relative;
        z-index: 2;
        background-color: var(--light-gray);
        padding: 0 10px;
      }

      .step-circle {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: #e0e0e0;
        color: #999;
        display: flex;
        justify-content: center;
        align-items: center;
        font-weight: 600;
        margin-bottom: 8px;
        transition: all 0.3s ease;
      }

      .step.active .step-circle {
        background-color: var(--dark-green);
        color: var(--white);
      }

      .step.completed .step-circle {
        background-color: var(--dark-green);
        color: var(--white);
      }

      .step.completed .step-circle::after {
        content: "âœ“";
      }

      .step-label {
        font-size: 0.9rem;
        color: #666;
        text-align: center;
      }

      .step.active .step-label {
        color: var(--dark-green);
        font-weight: 600;
      }

      /* Section Card */
      .section-card {
        background-color: var(--white);
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        padding: 1.5rem;
        margin-bottom: 1.5rem;
      }

      .section-title {
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--dark-green);
        margin-bottom: 1.5rem;
        padding-bottom: 0.5rem;
        border-bottom: 2px solid #e8f5e9;
      }

      /* Order Items */
      .order-item {
        display: flex;
        align-items: center;
        padding: 1rem 0;
        border-bottom: 1px solid #eee;
      }

      .order-item:last-child {
        border-bottom: none;
      }

      .order-item-img {
        width: 80px;
        height: 80px;
        object-fit: cover;
        border-radius: 8px;
        margin-right: 1rem;
      }

      .order-item-details {
        flex: 1;
      }

      .order-item-title {
        font-weight: 600;
        margin-bottom: 0.25rem;
      }

      .order-item-price {
        color: var(--dark-green);
        font-weight: 600;
      }

      .order-item-quantity {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .quantity-input {
        width: 50px;
        text-align: center;
        border: 1px solid #ddd;
        border-radius: 4px;
        pointer-events: none;
        background-color: #f5f5f5;
      }

      /* Price Breakdown */
      .price-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 0.75rem;
      }

      .price-row.total {
        font-weight: 700;
        font-size: 1.2rem;
        color: var(--dark-green);
        padding-top: 0.75rem;
        border-top: 2px solid #eee;
        margin-top: 0.75rem;
      }

      /* Place Order Button */
      .btn-place-order {
        background-color: var(--dark-green);
        color: var(--white);
        border: none;
        padding: 1rem;
        font-weight: 600;
        border-radius: 6px;
        width: 100%;
        transition: all 0.3s ease;
      }

      .btn-place-order:hover {
        background-color: #1b5e20;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }

      /* Mobile Responsive */
      @media (max-width: 768px) {
        .checkout-steps {
          overflow-x: auto;
          padding-bottom: 1rem;
        }

        .step {
          min-width: 100px;
        }

        .section-title {
          font-size: 1.3rem;
        }

        .order-item-img {
          width: 60px;
          height: 60px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Container -->
    <div class="container">
      <!-- Page Title -->
      <h1 class="text-center mb-4">Checkout</h1>

      <!-- Checkout Steps -->
      <div class="checkout-steps">
        <div class="step completed">
          <div class="step-circle">1</div>
          <div class="step-label">Keranjang</div>
        </div>
        <div class="step active">
          <div class="step-circle">2</div>
          <div class="step-label">Pengiriman</div>
        </div>
        <div class="step">
          <div class="step-circle">3</div>
          <div class="step-label">Pembayaran</div>
        </div>
        <div class="step">
          <div class="step-circle">4</div>
          <div class="step-label">Konfirmasi</div>
        </div>
      </div>

      <div class="row">
        <!-- Left Column: Order Summary & Shipping Info -->
        <div class="col-lg-8">
          <!-- Order Summary -->
          <div class="section-card">
            <h3 class="section-title">Ringkasan Pesanan</h3>
            <div id="order-items"></div>
          </div>

          <!-- Shipping Information -->
          <div class="section-card">
            <h3 class="section-title">Informasi Pengiriman</h3>
            <form>
              <!-- Name Fields -->
              <div class="row mb-3">
                <div class="col-md-6">
                  <label for="firstName" class="form-label">Nama Depan</label>
                  <input
                    type="text"
                    class="form-control"
                    id="firstName"
                    required
                  />
                </div>
                <div class="col-md-6">
                  <label for="lastName" class="form-label">Nama Belakang</label>
                  <input
                    type="text"
                    class="form-control"
                    id="lastName"
                    required
                  />
                </div>
              </div>

              <!-- Address -->
              <div class="mb-3">
                <label for="address" class="form-label">Alamat Lengkap</label>
                <textarea
                  class="form-control"
                  id="address"
                  rows="3"
                  required
                ></textarea>
              </div>

              <!-- Contact Info -->
              <div class="row mb-3">
                <div class="col-md-6">
                  <label for="phone" class="form-label">Nomor Telepon</label>
                  <input type="tel" class="form-control" id="phone" required />
                </div>
                <div class="col-md-6">
                  <label for="email" class="form-label">Email</label>
                  <input
                    type="email"
                    class="form-control"
                    id="email"
                    required
                  />
                </div>
              </div>

              <!-- City & Postal Code -->
              <div class="row mb-3">
                <div class="col-md-6">
                  <label for="city" class="form-label">Kota</label>
                  <select class="form-select" id="city" required>
                    <option value="" selected disabled>Pilih Kota</option>
                    <option value="jakarta">Jakarta</option>
                    <option value="bandung">Bandung</option>
                    <option value="surabaya">Surabaya</option>
                    <option value="bali">Bali</option>
                    <option value="yogyakarta">Yogyakarta</option>
                  </select>
                </div>
                <div class="col-md-6">
                  <label for="postalCode" class="form-label">Kode Pos</label>
                  <input
                    type="text"
                    class="form-control"
                    id="postalCode"
                    required
                  />
                </div>
              </div>

              <!-- Notes -->
              <div class="mb-3">
                <label for="notes" class="form-label">Catatan (Opsional)</label>
                <textarea class="form-control" id="notes" rows="2"></textarea>
              </div>
            </form>
          </div>
        </div>

        <!-- Right Column: Payment Summary -->
        <div class="col-lg-4">
          <div class="section-card">
            <h3 class="section-title">Ringkasan Pembayaran</h3>
            <div class="price-row">
              <span>Subtotal</span><span id="subtotal">Rp 0</span>
            </div>
            <div class="price-row">
              <span>Biaya Pengiriman</span><span id="shipping">Rp 15.000</span>
            </div>
            <div class="price-row">
              <span>Pajak (10%)</span><span id="tax">Rp 20.000</span>
            </div>
            <div class="price-row">
              <span>Diskon</span><span id="discount">Rp 0</span>
            </div>
            <div class="price-row total">
              <span>Total</span><span id="total">Rp 0</span>
            </div>
          </div>

          <!-- Place Order Button -->
          <button class="btn-place-order" onclick="placeOrder()">
            Proses Pembayaran
          </button>

          <!-- Security Note -->
          <div class="text-center mt-3">
            <p class="text-muted small">
              <i class="bi bi-shield-check"></i> Pembayaran Anda aman dan
              terenkripsi
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Custom Script -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Get cart and DOM elements
        const cart = JSON.parse(localStorage.getItem("cart")) || [];
        const container = document.getElementById("order-items");
        const totalharga = document.getElementById("total");
        const subtotal = document.getElementById("subtotal");
        const Pengiriman = document.getElementById("shipping");
        const tax = document.getElementById("tax");
        const diskon = document.getElementById("discount");
        const ongkir = 15000;

        // Format number to Rupiah
        function formatRupiah(angka) {
          return "Rp " + angka.toLocaleString("id-ID");
        }
        Pengiriman.textContent = formatRupiah(ongkir);

        // Render cart items
        function renderCart() {
          container.innerHTML = "";

          const produkcheckoutArray = []; // Array untuk localStorage

          cart.forEach((item) => {
            const div = document.createElement("div");
            div.className = "order-item";
            div.innerHTML = `
            <img src="${item.gambar}" alt="${item.nama}" class="order-item-img">
            <div class="order-item-details">
                <div class="order-item-title">${item.nama}</div>
                <div class="order-item-price">${formatRupiah(item.diskon)}</div>
            </div>
            <div class="order-item-quantity">
                <input type="number" class="quantity-input" value="${
                  item.quantity
                }" min="1">
            </div>
        `;
            container.appendChild(div);

            // Tambahkan setiap item ke array
            produkcheckoutArray.push({
              nama: item.nama,
              harga: item.diskon,
              gambar: item.gambar,
              quantity: item.quantity,
            });
          });

          // Simpan seluruh array ke localStorage
          localStorage.setItem(
            "produkcheckout",
            JSON.stringify(produkcheckoutArray)
          );

          updateTotal();
        }

        // Update total, tax, discount
        function updateTotal() {
          const subvalue = cart.reduce(
            (sum, item) => sum + item.diskon * item.quantity,
            0
          );
          subtotal.textContent = formatRupiah(subvalue);
          const taxval = subvalue * 0.1;
          tax.textContent = formatRupiah(taxval);
          const hargadiskon = cart.reduce(
            (sum, item) => sum + item.diskon * 0.5,
            0
          );
          diskon.textContent = formatRupiah(hargadiskon);
          totalharga.textContent = formatRupiah(
            subvalue + ongkir + taxval - hargadiskon
          );

          // Save prices to localStorage
          const keseluruhan = {
            subtotal: subvalue,
            pajak: taxval,
            diskon: hargadiskon,
            total: totalharga.textContent,
          };
          localStorage.setItem("harga", JSON.stringify(keseluruhan));
        }

        // Place Order Function
        window.placeOrder = function () {
          const firstName = document.getElementById("firstName").value;
          const lastName = document.getElementById("lastName").value;
          const address = document.getElementById("address").value;
          const phone = document.getElementById("phone").value;
          const email = document.getElementById("email").value;
          const city =
            document.getElementById("city").options[
              document.getElementById("city").selectedIndex
            ].text;
          const postalCode = document.getElementById("postalCode").value;
          const notes = document.getElementById("notes").value;

          if (
            !firstName ||
            !lastName ||
            !address ||
            !phone ||
            !email ||
            !city ||
            !postalCode
          ) {
            alert("Harap lengkapi semua informasi pengiriman");
            return;
          }

          // Save shipping info to localStorage
          const shippingData = {
            name: firstName + " " + lastName,
            address,
            city,
            postalCode,
            phone,
            email,
            notes,
          };
          localStorage.setItem(
            "skarden_shipping",
            JSON.stringify(shippingData)
          );

          // Redirect to payment page
          window.location.href = "payment.html";
        };

        // Initial render
        renderCart();
      });
    </script>
  </body>
</html>
